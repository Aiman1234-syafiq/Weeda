{% extends "base.html" %}

{% block title %}Create New PR{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Create New Purchase Requisition</h1>
    <p class="page-description">Fill in the details below to create a new PR</p>
</div>

<div class="card">
    <form method="POST" action="/pr/new">
        <div class="form-row">
            <div class="form-group">
                <label for="requester_name">Requester Name *</label>
                <input type="text" class="form-control" id="requester_name" 
                       name="requester_name" value="{{ session.name }}" required>
            </div>
            
            <div class="form-group">
                <label for="department">Department *</label>
                <select class="form-control" id="department" name="department" required>
                    <option value="">Select Department</option>
                    <option value="it">IT Department</option>
                    <option value="hr">Human Resources</option>
                    <option value="finance">Finance</option>
                    <option value="operations">Operations</option>
                    <option value="marketing">Marketing</option>
                    <option value="sales">Sales</option>
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label for="purpose">Purpose / Description *</label>
            <textarea class="form-control" id="purpose" name="purpose" 
                      rows="3" required placeholder="Describe what you need to purchase and why..."></textarea>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="vendor_name">Vendor Name *</label>
                <input type="text" class="form-control" id="vendor_name" 
                       name="vendor_name" required placeholder="Company or supplier name">
            </div>
            
            <div class="form-group">
                <label for="total_amount">Total Amount ($) *</label>
                <input type="number" class="form-control" id="total_amount" 
                       name="total_amount" step="0.01" min="0" required placeholder="0.00">
                <small style="color: var(--secondary); margin-top: 0.5rem; display: block;">
                    Approval path:
                    <ul style="margin-left: 1rem; margin-top: 0.25rem;">
                        <li>≤ $10,000: Approver 1 only</li>
                        <li>$10,001 - $49,999: Approver 2 → Approver 3</li>
                        <li>≥ $50,000: Approver 4 only</li>
                    </ul>
                </small>
            </div>
        </div>
        
        <div class="d-flex justify-between mt-3">
            <a href="/dashboard" class="btn btn-secondary">Cancel</a>
            <button type="submit" class="btn btn-primary">Save as Draft</button>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('total_amount').addEventListener('input', function() {
        const amount = parseFloat(this.value) || 0;
        const pathInfo = document.getElementById('path-info');
        
        let path = '';
        if (amount <= 10000) {
            path = 'Approver 1';
        } else if (amount < 50000) {
            path = 'Approver 2 → Approver 3';
        } else {
            path = 'Approver 4';
        }
        
        this.setAttribute('data-path', path);
    });
</script>
{% endblock %}